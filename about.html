<!-- about.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>タイトル：メモのページ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="content">
    <h1>２ページめ</h1>
    <p>これは学習用に作成したWebページです。</p>
    <section>
    <h2>メモ</h2>
      <div class="small-text">
    <p>
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
AWS全リソース削除・完全シャットダウン手順書

【フェーズ1：存在確認（棚卸し）】
1. 請求ベースの確認
   - [請求ダッシュボード] ＞ [請求書] で「サービス名」と「リージョン」を特定。

2. リソースエクスプローラーでの検索
   - [Resource Explorer] で全リージョンのリソースを一覧化。

【フェーズ2：削除作業（エラー回避・依存関係順）】
※「外側の枠」から順に剥がしていくことで、依存関係エラーを防ぎます。

3. AMI (Amazon マシンイメージ) の登録解除
   - [EC2] ＞ [イメージ] ＞ [AMI] ＞ 「登録解除」。
   - 理由：スナップショットを削除するための前提条件。

4. スナップショットの削除
   - [EC2] ＞ [ストレージ] ＞ [スナップショット] ＞ すべて削除。
   - 理由：AMIを解除した直後に削除可能になるため。

5. ネットワークの「出口・窓口」の解除（重要：依存関係の解消）
   - 5-1. Route 53：レコード削除。
   - 5-2. CloudFront：無効化(Disable)を実行。※反映に時間がかかるため早めに行う。（有無？）
   - 5-3. AWS WAF：Web ACLを CloudFront や ALB から「Disassociate（紐付け解除）」する。
   - 理由：WAFやDNSが参照している間は、下のレイヤーのリソースを消せない場合があるため。

6. コンピューティング（本体）の終了
   - 6-1. RDS (データベース) の削除：最終スナップショット作成をオフにして削除。※削除中も他のEC2やS3の作業は進められます。
   - 6-2. EC2 インスタンスの終了：停止状態から「終了 (Terminate)」を実行。
   - 理由：参照元のWAFやELBの設定を外した後に本体を消すのが最も安全。

7. CloudTrail の停止・削除
   - [CloudTrail] ＞ [証跡 (Trails)] ＞ 「削除」。
   - 理由：S3バケットへの「書き込み中」状態を解除するため。

8. S3 (ストレージ) の削除
   - [S3] ＞ [バケット] ＞ 「空にする」の後に「削除」。
   - 理由：CloudTrailやCloudFrontからの書き込み・参照がすべて止まったこのタイミングが最短。

9. 残存ネットワークリソースの完全解放
   - 9-1. ELB (ロードバランサー)：削除。
   - 9-2. Elastic IP：アドレスを「解放」。
   - 9-3. CloudFront：(5-2で無効化済みのものを) 削除。
   - 9-4. ACM (証明書)：削除。

【フェーズ3：削除後の確認とアカウント解約】

10. 翌日のコスト確認
   - [AWS Cost Explorer] で日次の料金が「0円」であることを確認。

11. アカウントの解約
   - ルートユーザーでログイン ＞ [アカウント] ＞ ページ最下部 [アカウントの解約]。

－－－－－－－－－－－－－－－－－－－－－－－－－－－
今回の修正で「本当に大丈夫」な理由
WAFを先に「外す」: WAFをCloudFrontやALBに紐付けたままだと、削除時に「リソースが使用中」というエラーが出ることがあります。
先に紐付けを解除（ステップ5-3）することで、後の工程がスムーズになります。

CloudFrontを早めに「無効化」: CloudFrontの停止と削除には時間がかかります。
最初に無効化指示を出し、他の作業をしている間に削除可能な状態（デプロイ完了）に持っていく構成にしました。

CloudTrail → S3 の順序: 前回の検討通り、S3を消す直前にCloudTrailの書き込みを止めることで、バケット削除エラーを防いでいます。

この手順書は、**「前任者がどのような複雑な紐付けをしていようとも、外側から1枚ずつ皮を剥くように消去できる」**設計です。

まずは**フェーズ1の「請求書」**を手元に用意し、このテキストをチェックリストとして1項目ずつ塗りつぶしながら進めてみてください。
      
－－－－－－－－－－－－－－－－－－－－－－－－－－－
作業をスムーズに進めるための「タイマー」戦略
以下の順序で「待ち時間が発生するもの」をポチポチと先に実行し、待ち時間の間に細かいリソースを消していくのが最も効率的です。

1.まずやる（待ち時間スタート）

　CloudFrontの「無効化（Disable）」
　S3バケットの「空にする（Empty）」の実行
　RDSの「削除」実行

2.待ち時間の間にやる（即座に消えるもの）

　AMIの登録解除
　スナップショットの削除
　Elastic IPの解放
　IAMユーザーの整理

3.最後にやる（反映を確認してから）

　CloudFrontの「削除（Delete）」（無効化が完了しているはず）
　S3バケットの「削除」（空になっているはず）
　WAFの削除（紐付けが解けているはず）

まとめ：一番の「伏兵」はS3です
前任者がログファイルを大量に溜め込んでいた場合、S3の「空にする」ボタンを押してから終わるまでが一番の待ち時間になります。

まずは 「CloudFrontの無効化」と「S3のファイル量」 を真っ先に確認してみるのが、作業を早く終わらせるコツです。
－－－－－－－－－－－－－－－－－－－－－－－－－－－
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－
    </p>
    </section>
    <p><a href="index.html">戻る</a></p>
  </div>  
</body>
</html>
